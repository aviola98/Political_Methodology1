---
title: "Trabalho Final"
author: "André Viola"
date: "7/27/2021"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE}
#limpando o documento html final
knitr::opts_chunk$set(echo=FALSE,error=FALSE,warning=FALSE,message=FALSE)
```

```{r}
library(tidyverse)
library(knitr)
library(cowplot)
library(ggpubr)
```

```{r}
#2002
eleicao_2002_exterior <- read_delim("votacao_secao_2002_ZZ.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2002_exterior <-
eleicao_2002_exterior %>%
  filter(NUM_TURNO==2) %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2002ext <-  100*(20772/36043)
pct_voto_inc2002ext <-   100*(13742/36043)
voto_branco2002ext  <-    100*(749/36043)
voto_null2002ext  <-    100*(780/36043)


eleicao_2002_br <- read_delim("votacao_secao_2002_BR.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2002_br <- eleicao_2002_br %>%
  filter(SIGLA_UF != "ZZ" & NUM_TURNO == 2) %>%
  select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2002br <-  100*(52772592/91628216)
pct_voto_inc2002br <-   100*(33356997/91628216)
voto_branco2002br  <-      100*(1727011/91628216)
voto_null2002br  <-    100*(3771358/91628216)
x <- 100*(258/91628216)
```

```{r}
#2006
eleicao_2006_exterior <- read_delim("votacao_secao_2006_ZZ.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2006_exterior <-
eleicao_2006_exterior %>%
  filter(NUM_TURNO==2) %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2006ext <-  100*(20912/40883)
pct_voto_inc2006ext <-  100*(17948/40883)
voto_branco2006ext  <-  100*(985/40883)
voto_null2006ext  <-    100*(1038/40883)

eleicao_2006_br <- read_delim("votacao_secao_2006_BR.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))


eleicao_2006_br <- eleicao_2006_br %>%
  filter(SIGLA_UF != "ZZ" & NUM_TURNO==2) %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)
  

pct_voto_opo2006br <-  100*(37543178/101998221)
pct_voto_inc2006br <-   100*(58295042/101998221)
voto_branco2006br  <-      100*(1351448/101998221)
voto_null2006br  <-    100*(4808553/101998221)
```


```{r}
#2010
eleicao_2010_exterior <- read_delim("votacao_secao_2010_ZZ.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2010_exterior <-
eleicao_2010_exterior %>%
  filter(NUM_TURNO==2) %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2010ext <-  100*(47913/85591)
pct_voto_inc2010ext <-  100*(33112/85591)
voto_branco2010ext  <-  100*(2313/85591)
voto_null2010ext    <-  100*(2253/85591)


eleicao_2010_br <- read_delim("votacao_secao_2010_BR.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2010_br <-
eleicao_2010_br %>%
  filter(SIGLA_UF != "ZZ" & NUM_TURNO==2) %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2010br <-  100*(43638458/106465483)
pct_voto_inc2010br <-  100*(55691399/106465483)
voto_branco2010br  <-  100*(2449553/106465483)
voto_null2010br   <-  100*(4685801/106465483)
```

```{r}
#2014

eleicao_2014 <- read_delim("votacao_secao_2014_BR.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2014_exterior <-
eleicao_2014 %>%
  filter(NUM_TURNO==2 
         & SIGLA_UF == "ZZ") %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2014ext <-  100*(104121/141873)
pct_voto_inc2014ext <-  100*(31059/141873)
voto_branco2014ext  <-  100*(3159/141873)
voto_null2014ext  <-    100*(3534/141873)

eleicao_2014_br <- eleicao_2014 %>%
  filter(SIGLA_UF != "ZZ" & NUM_TURNO == 2) %>%
   select(-DATA_GERACAO,-HORA_GERACAO,-DESCRICAO_ELEICAO,-SIGLA_UE,-NUM_SECAO,-CODIGO_CARGO,-SIGLA_UE)

pct_voto_opo2014br <-  100*(50937034/112542006)
pct_voto_inc2014br <-  100*(54470059/112542006)
voto_branco2014br  <-  100*(1918660/112542006)
voto_null2014br  <-    100*(5216253/112542006)
```

```{r}
#2018

eleicao_2018 <- read_delim("votacao_secao_2018_BR.csv",
                           delim = ";",
                           locale=locale(encoding="latin1"))

eleicao_2018_exterior <-                            
eleicao_2018 %>%
  filter(SG_UF == "ZZ" & NR_TURNO==2) %>%
  select(-DT_GERACAO,-HH_GERACAO,-CD_TIPO_ELEICAO,-NM_TIPO_ELEICAO,-CD_ELEICAO,-DT_ELEICAO,-TP_ABRANGENCIA,-NM_UE,-NR_SECAO,-CD_CARGO,-SG_UE) %>%
  mutate(PAIS = case_when(NM_MUNICIPIO == "TÓQUIO" ~ "JAPÃO",
                          NM_MUNICIPIO == "OSLO" ~ "NORUEGA",
                          NM_MUNICIPIO == "WASHINGTON" ~ "EUA",
                          NM_MUNICIPIO == "BARCELONA" ~"ESPANHA",
                          NM_MUNICIPIO == "PARIS" ~ "FRANÇA",
                          NM_MUNICIPIO == "GENEBRA" ~"SUIÇA",
                          NM_MUNICIPIO == "VANCOUVER" ~"CANADÁ",
                          NM_MUNICIPIO == "FRANKFURT" ~ "ALEMANHA", NM_MUNICIPIO == "NOVA YORK" ~ "EUA",
                          NM_MUNICIPIO == "BOSTON" ~"EUA",
                          NM_MUNICIPIO == "NAGÓIA" ~ "JAPÃO", 
                          NM_MUNICIPIO == "LONDRES" ~"REINO UNIDO",
                          NM_MUNICIPIO == "CANTÃO" ~"CHINA",
                          NM_MUNICIPIO == "PRAIA"~"CABO VERDE",
                          NM_MUNICIPIO == "MIAMI" ~"EUA",
                          NM_MUNICIPIO == "MONTREAL" ~"CANADÁ",
                          NM_MUNICIPIO == "LISBOA"~"PORTUGAL",
                          NM_MUNICIPIO == "HAMAMATSU"~"JAPÃO",
                          NM_MUNICIPIO == "DUBLIN"~"IRLANDA",
                          NM_MUNICIPIO == "ROMA"~"ITÁLIA",
                          NM_MUNICIPIO == "MUNIQUE"~"ALEMANHA",
                          NM_MUNICIPIO == "MADRI"~"ESPANHA", NM_MUNICIPIO == "HOUSTON"~"EUA",
                          NM_MUNICIPIO == "BRUXELAS"~"BÉLGICA",
                          NM_MUNICIPIO == "MILÃO"~"ITÁLIA",
                          NM_MUNICIPIO == "BUENOS AIRES"~"ARGENTINA",
                          NM_MUNICIPIO == "ATLANTA"~"EUA",
                          NM_MUNICIPIO == "WELLINGTON"~"NOVA ZELÂNDIA",
                          NM_MUNICIPIO == "BERLIM"~"ALEMANHA",
                          NM_MUNICIPIO == "PANAMÁ-PAN"~"PANAMÁ",
                          NM_MUNICIPIO == "TEL AVIV"~"ISRAEL",
                          NM_MUNICIPIO == "ESTOCOLMO"~"SUÉCIA",
                          NM_MUNICIPIO == "FARO"~"PORTUGAL",
                          NM_MUNICIPIO == "ASSUNÇÃO"~"PARAGUAY",
                          NM_MUNICIPIO == "SEUL"~"CORÉIA DO SUL",
                          NM_MUNICIPIO == "PORTO PRÍNCIPE"~"HAITI",
                          NM_MUNICIPIO == "ROTTERDÃ"~"HOLANDA",
                          NM_MUNICIPIO == "CAMBERRA" ~"AUSTRÁLIA",
                          NM_MUNICIPIO == "CHICAGO"~"EUA",
                          NM_MUNICIPIO == "MOSCOU" ~ "RUSSIA",
                          NM_MUNICIPIO == "TORONTO" ~ "CANADÁ",
                          NM_MUNICIPIO == "PEQUIM" ~ "CHINA",
                          NM_MUNICIPIO == "COCHABAMBA"~"BOLÍVIA",
                          NM_MUNICIPIO == "SÃO FRANCISCO" ~"EUA",
                          NM_MUNICIPIO == "SÃO DOMINGOS"~ "REPÚBLICA DOMINICANA",
                          NM_MUNICIPIO == "SYDNEY"~"AUSTRÁLIA",NM_MUNICIPIO == "VARSÓVIA"~"POLONIA",
                          NM_MUNICIPIO == "VIENA"~"AUSTRIA", NM_MUNICIPIO == "SINGAPURA-SING"~"SINGAPURA", 
                          NM_MUNICIPIO == "DÍLI"~ "INDIA",
                          NM_MUNICIPIO == "MONTEVIDÉU"~"URUGUAY",
                          NM_MUNICIPIO == "CARACAS" ~"VENEZUELA",
                          NM_MUNICIPIO == "PEDRO JUAN CABALLERO"~"PARAGUAY",
                          NM_MUNICIPIO == "HARTFORD"~"EUA",
                          NM_MUNICIPIO == "BOGOTÁ"~"COLOMBIA",
                          NM_MUNICIPIO == "QUITO"~"EQUADOR",
                          NM_MUNICIPIO == "CAIENA"~"FRANÇA",
                          NM_MUNICIPIO == "DAR ES SALAAM"~"TANZÂNIA",
                          NM_MUNICIPIO == "LAGOS"~"NIGÉRIA",
                          NM_MUNICIPIO == "PORTO"~"PORTUGAL",
                          NM_MUNICIPIO == "TALIN"~"ESTÔNIA",
                          NM_MUNICIPIO == "BUDAPESTE"~"HUNGRIA",
                          NM_MUNICIPIO == "MAPUTO"~"MOÇAMBIQUE",
                          NM_MUNICIPIO == "PRETÓRIA"~"AFRICA DO SUL",
                          NM_MUNICIPIO == "MANILA"~"FILIPINAS",
                          NM_MUNICIPIO == "TEGUCIGALPA"~"HONDURAS",
                          NM_MUNICIPIO == "BUCARESTE"~"ROMÊNIA",
                          NM_MUNICIPIO == "LIMA"~"PERU",
                          NM_MUNICIPIO == "LOS ANGELES"~"EUA",
                          NM_MUNICIPIO == "NAIRÓBI"~"QUENIA",
                          NM_MUNICIPIO == "SALTO DEL GUAIRÁ"~"PARAGUAY",
                          NM_MUNICIPIO == "TAIPÉ"~"TAIWAN",
                          NM_MUNICIPIO == "CIUDAD DEL ESTE"~"PARAGUAY",
                          NM_MUNICIPIO == "STA C LA SIERRA-BOLI"~"BOLÍVIA",
                          NM_MUNICIPIO == "XANGAI"~"CHINA",
                          NM_MUNICIPIO == "SÃO JOSÉ"~"EUA",
                          NM_MUNICIPIO == "CHUY"~"URUGUAY",
                          NM_MUNICIPIO == "BRATISLAVA"~"ESLOVÁQUIA",
                          NM_MUNICIPIO == "OTTAWA"~"CANADÁ",
                          NM_MUNICIPIO =="BEIRUTE"~"LIBANO",
                          NM_MUNICIPIO == "JACARTA"~"INDONÉSIA",
                          NM_MUNICIPIO == "MÉXICO-MEXI"~"MÉXICO",
                          NM_MUNICIPIO == "TEERÃ"~"IRÃ",
                          NM_MUNICIPIO =="MASCATE"~"OMÃ",
                          NM_MUNICIPIO == "HONG KONG-HONG"~"HONG KONG",
                          NM_MUNICIPIO == "COPENHAGUE-DINA"~"DINAMARCA",
                          NM_MUNICIPIO == "ABU DHABI"~"EAU",
                          NM_MUNICIPIO == "PARAMARIBO"~"SURINAME",
                          NM_MUNICIPIO == "NOVA DELHI"~"INDIA",
                          NM_MUNICIPIO == "KUAITE" ~"KUAITE",
                          NM_MUNICIPIO == "MENDOZA"~"ARGENTINA",
                          NM_MUNICIPIO == "KIEV" ~ "UCRÂNIA",
                          NM_MUNICIPIO == "ATENAS" ~ "GRÉCIA",
                          NM_MUNICIPIO == "RIADE"~"ARÁBIA SAUDITA",
                          NM_MUNICIPIO == "DOHA" ~"QATAR",
                          NM_MUNICIPIO == "CIUDAD GUYANA"~"VENEZUELA",
                          NM_MUNICIPIO == "ZAGREB"~"CROÁCIA",
                          NM_MUNICIPIO == "CONCEPCIÓN"~"CHILE",
                          NM_MUNICIPIO == "AMÃ"~"JORDÂNIA",
                          NM_MUNICIPIO == "LUANDA"~"ANGOLA",
                          NM_MUNICIPIO == "BISSAU"~"GUINÉ BISSAU",
                          NM_MUNICIPIO == "RABAT"~"MARROCOS",
                          NM_MUNICIPIO == "ZURIQUE"~"SUIÇA",
                          NM_MUNICIPIO == "WINDHOEK"~"NAMÍBIA",
                        NM_MUNICIPIO == "RAMALLAH-PALE"~"PALESTINA", NM_MUNICIPIO == "TUNIS"~"TUNISIA", NM_MUNICIPIO == "CIUDAD GUAYANA"~"VENEZUELA", NM_MUNICIPIO == "GUATEMALA"~"GUATEMALA", NM_MUNICIPIO == "BELGRADO"~"SÉRVIA", NM_MUNICIPIO == "ARTIGAS"~"URUGUAY",
                        NM_MUNICIPIO == "LA PAZ"~"BOLÍVIA",
                        NM_MUNICIPIO == "SANTIAGO" ~"CHILE",
                        NM_MUNICIPIO == "ABIDJÃ"~"COSTA DO MARFIM", NM_MUNICIPIO == "ACCRA-GANA"~"GANA",
                        NM_MUNICIPIO == "ANCARA"~"TURQUIA", NM_MUNICIPIO == "BANGKOK"~"TAILANDIA", NM_MUNICIPIO == "CAIRO"~"EGITO",
                      NM_MUNICIPIO == "CIDADE DO CABO"~"AFRICA DO SUL",
                      NM_MUNICIPIO == "CÓRDOBA"~"ARGENTINA",
                      NM_MUNICIPIO == "DACAR"~"SENEGAL",
                      NM_MUNICIPIO == "ENCARNACIÓN"~"PARAGUAY",
                      NM_MUNICIPIO == "GEORGETOWN"~"GUIANA",
                      NM_MUNICIPIO == "HANÓI"~"VIETNÃ",
                      NM_MUNICIPIO == "HAVANA"~"CUBA",
                      NM_MUNICIPIO == "HELSINQUE"~"FINLÂNDIA",
                      NM_MUNICIPIO == "ISTAMBUL"~"TURQUIA",
                      NM_MUNICIPIO == "KATMANDU"~"NEPAL",
                      NM_MUNICIPIO == "KINGSTON-JAMAICA"~"JAMAICA",
                      NM_MUNICIPIO == "KINSHASA"~"REP.DEM. DO CONGO",
                      NM_MUNICIPIO == "KUALA LUMPUR"~"MALÁSIA",
                      NM_MUNICIPIO == "LIUBLIANA"~"ESLOVÊNIA",
                      NM_MUNICIPIO == "LUSACA"~"ZÂMBIA",
                      NM_MUNICIPIO == "MANÁGUA"~"NICARÁGUA",
                      NM_MUNICIPIO == "NASSAU"~"BAHAMAS",
                      NM_MUNICIPIO == "NICOSIA"~"CIPRE",
                      NM_MUNICIPIO == "PORT OF SPAIN"~"TRINIDAD E TOBAGO",
                      NM_MUNICIPIO == "PRAGA"~"REPÚBLICA TCHECA",
                      NM_MUNICIPIO == "RIO BRANCO"~"URUGUAY",
                      NM_MUNICIPIO == "SÃO SALVADOR"~"EL SALVADOR"
                        
                        
                       ))

eleicao_2018_exterior <-
eleicao_2018_exterior %>%
  mutate(REGIAO=case_when(PAIS %in% c("JAPÃO",
                          "CHINA",
                          "ARÁBIA SAUDITA",
                          "EAU",
                          "FILIPINAS",
                          "HONG KONG",
                          "INDONÉSIA",
                          "IRÃ",
                          "CORÉIA DO SUL",
                          "ISRAEL",
                          "JORDÂNIA",
                          "KUAITE",
                          "LIBANO",
                          "MALÁSIA",
                          "INDIA",
                          "QATAR",
                          "SINGAPURA",
                          "TAILANDIA",
                          "TAIWAN",
                          "TURQUIA",
                          "NEPAL",
                          "OMÃ",
                          "VIETNÃ",
                          "PALESTINA") ~ "ÁSIA",
                          PAIS %in% c("AFRICA DO SUL",
                          "ANGOLA",
                          "CABO VERDE",
                          "COSTA DO MARFIM",
                          "EGITO",
                          "GANA",
                          "ZÂMBIA",
                          "GUINÉ BISSAU",
                          "MARROCOS",
                          "MOÇAMBIQUE",
                          "NAMÍBIA",
                          "TANZÂNIA",
                          "NIGÉRIA",
                          "QUENIA",
                          "SENEGAL",
                          "TUNISIA",
                          "REP.DEM. DO CONGO")~"ÁFRICA",
                          PAIS %in% c("ALEMANHA",
                          "AUSTRIA",
                          "BÉLGICA",
                          "CIPRE",
                          "CROÁCIA",
                         "DINAMARCA",
                        "ESLOVÁQUIA",
                        "ESLOVÊNIA",
                        "ESPANHA",
                        "ESTÔNIA",
                       "FINLÂNDIA",
                       "FRANÇA",
                       "GRÉCIA",
                       "HOLANDA",
                       "HUNGRIA",
                       "IRLANDA",
                       "ITÁLIA",
                      "NORUEGA",
                      "POLONIA",
                      "PORTUGAL",
                      "REINO UNIDO",
                      "REPÚBLICA TCHECA",
                     "ROMÊNIA",
                     "RUSSIA",
                     "SÉRVIA",
                     "SUÉCIA",
                     "SUIÇA",
                     "UCRÂNIA")~"EUROPA",
                     PAIS %in% c("AUSTRÁLIA",
                     "NOVA ZELÂNDIA") ~ "OCEANIA",
                     PAIS %in% c("PARAGUAY",
                                 "EUA",
                                 "GUIANA",
                                 "BOLÍVIA",
                                 "TRINIDAD E TOBAGO",
                                 "VENEZUELA",
                                 "EL SALVADOR",
                                 "SURINAME",
                                 "GUATEMALA",
                                 "JAMAICA",
                                 "REPÚBLICA DOMINICANA",
                                 "URUGUAY",
                                 "HONDURAS",
                                 "BAHAMAS",
                                 "PERU",
                                 "HAITI",
                                 "COSTA RICA",
                                 "MÉXICO",
                                 "CANADÁ",
                                 "ARGENTINA",
                                 "CHILE",
                                 "PANAMÁ",
                                 "EQUADOR",
                                 "NICARÁGUA",
                                 "COLOMBIA",
                                 "CUBA")~"AMÉRICA"))


eleicao_2018_BR <- eleicao_2018 %>%
  filter(SG_UF != "ZZ" & NR_TURNO==2) %>%
  select(-DT_GERACAO,-HH_GERACAO,-CD_TIPO_ELEICAO,-NM_TIPO_ELEICAO,-CD_ELEICAO,-DT_ELEICAO,-TP_ABRANGENCIA,-NM_UE,-NR_SECAO,-CD_CARGO,-SG_UE)

pct_voto_opo2018ext <-  100*(131671/201166)
pct_voto_inc2018ext <-  100*(53730/201166)
voto_branco2018ext  <-  100*(7241/201166)
voto_null2018ext  <-    100*(8524/201166)

pct_voto_opo2018br <-  100*(57666176/115732285)
pct_voto_inc2018br <-  100*(46987176/115732285)
voto_branco2018br  <-  100*(2479352/115732285)
voto_null2018br  <-    100*(8599581/115732285)
```

```{r}

br_2018 <-
  eleicao_2018_BR %>%
  rename("NUM_TURNO"="NR_TURNO",
         "SIGLA_UF"="SG_UF",
         "CODIGO_MUNICIPIO"="CD_MUNICIPIO",
         "NOME_MUNICIPIO"="NM_MUNICIPIO",
         "NUM_ZONA"="NR_ZONA",
         "DESCRICAO_CARGO"="DS_CARGO",
         "NUM_ZONA"="NR_ZONA",
         "DESCRICAO_CARGO"="DS_CARGO",
         "NUM_VOTAVEL"="NR_VOTAVEL",
         "QTDE_VOTOS"="QT_VOTOS") %>%
  select(-DS_ELEICAO,
         -NM_VOTAVEL)

exterior_2018 <-
  eleicao_2018_exterior %>%
  rename("NUM_TURNO"="NR_TURNO",
         "SIGLA_UF"="SG_UF",
         "CODIGO_MUNICIPIO"="CD_MUNICIPIO",
         "NOME_MUNICIPIO"="NM_MUNICIPIO",
         "NUM_ZONA"="NR_ZONA",
         "DESCRICAO_CARGO"="DS_CARGO",
         "NUM_ZONA"="NR_ZONA",
         "DESCRICAO_CARGO"="DS_CARGO",
         "NUM_VOTAVEL"="NR_VOTAVEL",
         "QTDE_VOTOS"="QT_VOTOS") %>%
  select(-DS_ELEICAO,
         -NM_VOTAVEL,
         -PAIS,
         -REGIAO)

binded_br<-
rbind(eleicao_2006_br,eleicao_2002_br,eleicao_2010_br,eleicao_2014_br,br_2018)


binded_ext <-
  rbind(eleicao_2002_exterior,
        eleicao_2006_exterior,
        eleicao_2010_exterior,
        eleicao_2014_exterior,
        exterior_2018)

binded_br <-
binded_br %>%
  mutate(CASE=case_when(NUM_VOTAVEL==13 & ANO_ELEICAO == 2002 ~ "OPOSICAO",
                        NUM_VOTAVEL==13 & ANO_ELEICAO != 2002 ~ "INCUMBENTE",
                        NUM_VOTAVEL==45 & ANO_ELEICAO == 2002 ~"INCUMBENTE",
                        NUM_VOTAVEL==45 & ANO_ELEICAO != 2002 ~"OPOSIÇÃO",
                        NUM_VOTAVEL==17 ~ "OPOSIÇÃO"))

binded_ext <-
  binded_ext %>%
  mutate(CASE=case_when(NUM_VOTAVEL==13 & ANO_ELEICAO == 2002 ~ "OPOSICAO",
                        NUM_VOTAVEL==13 & ANO_ELEICAO != 2002 ~ "INCUMBENTE",
                        NUM_VOTAVEL==45 & ANO_ELEICAO == 2002 ~"INCUMBENTE",
                        NUM_VOTAVEL==45 & ANO_ELEICAO != 2002 ~"OPOSIÇÃO",
                        NUM_VOTAVEL==17 ~ "OPOSIÇÃO"))


hist_op_br <-
binded_br %>%
  group_by(ANO_ELEICAO) %>%
  filter(CASE=="OPOSIÇÃO" &
           SIGLA_UF != "ZZ") %>%
  ggplot()+
  geom_histogram(aes(x=QTDE_VOTOS),
                  colour="black",
                 fill="blue") +
  ggtitle("Oposição (Brasil)")

hist_inc_br <- 
  binded_br %>%
    group_by(ANO_ELEICAO) %>%
  filter(CASE=="INCUMBENTE" &
           SIGLA_UF != "ZZ") %>%
  ggplot()+
  geom_histogram(aes(x=QTDE_VOTOS),
                  colour="black",
                 fill="orange")+
  ggtitle("Incumbente (Brasil)")

hist_op_ext <-
  binded_ext %>%
  group_by(ANO_ELEICAO) %>%
  filter(CASE=="OPOSIÇÃO" &
           SIGLA_UF=="ZZ") %>%
  ggplot()+
  geom_histogram(aes(x=QTDE_VOTOS),
                  colour="black",
                 fill="blue") +
  ggtitle("Oposição (Exterior)")

hist_inc_ext <-
  binded_ext %>%
  group_by(ANO_ELEICAO) %>%
  filter(CASE=="INCUMBENTE" &
           SIGLA_UF=="ZZ") %>%
  ggplot()+
  geom_histogram(aes(x=QTDE_VOTOS),
                  colour="black",
                 fill="orange") +
  ggtitle("Incumbente (Exterior)")

ggarrange(hist_inc_br,hist_inc_ext,
          hist_op_br,hist_op_ext,
          ncol = 2,nrow = 2)

```


```{r}
tabela_1 <- tibble(ANO=c(2002,2006,2010,2014,2018),
                   PCT_VOTO_INCBR=c(pct_voto_inc2002br,pct_voto_inc2006br,
                                    pct_voto_inc2010br,pct_voto_inc2014br,
                                    pct_voto_inc2018br),
                   PCT_VOTO_OPBR=c(pct_voto_opo2002br,pct_voto_opo2006br,
                                   pct_voto_opo2010br,pct_voto_opo2014br,pct_voto_opo2018br),
                   PCT_VOTO_INCEXT=c(pct_voto_inc2002ext,pct_voto_inc2006ext,pct_voto_inc2010ext,pct_voto_inc2014ext, pct_voto_inc2018ext),
                   PCT_VOTO_OPEXT=c(pct_voto_opo2002ext,pct_voto_opo2006ext,pct_voto_opo2010ext,pct_voto_opo2014ext,pct_voto_opo2018ext),
                   PCT_VOTO_BRANCO_NULOBR=c(voto_branco2002br + voto_null2002br,
                                       voto_branco2006br + voto_null2006br,
                                       voto_branco2010br + voto_null2010br,
                                       voto_branco2014br + voto_null2014br,
                                       voto_branco2018br + voto_null2018br),
                   PCT_VOTO_BRANCONULOEXT = c(voto_branco2002ext + voto_null2002ext,
                                       voto_branco2006ext + voto_null2006ext,
                                       voto_branco2010ext + voto_null2010ext,
                                       voto_branco2014ext + voto_null2014ext,
                                       voto_branco2018ext + voto_null2018ext))

tabela_1_display <-
tabela_1 %>% 
  kable(caption = "Porcentagem de votos no Brasil e Exterior nas eleições presidenciais brasileiras entre 2002-2018",
        col.names = c("Ano","% voto incumbente(Brasil)", "% de voto oposição (Brasil)", "% de voto incumbente(Exterior)",
                      "% de voto oposição(Exterior)", "% de voto branco/nulo (Brasil)","% de voto branco/nulo (Exterior)"))

tabela_1_display
```

```{r}

estat_br <-
tabela_1 %>%        summarise(media_votos_incbr=mean(PCT_VOTO_INCBR),                     median_votos_incbr=median(PCT_VOTO_INCBR),
        sd_voto_incbr=sd(PCT_VOTO_INCBR),
        media_votos_opbr=mean(PCT_VOTO_OPBR),
        median_votos_opbr=median(PCT_VOTO_OPBR),
        sd_voto_opbr=sd(PCT_VOTO_OPBR),
        media_nullbr=mean(PCT_VOTO_BRANCO_NULOBR),
        median_nullbr=median(PCT_VOTO_BRANCO_NULOBR),
        sd_nullbr=sd(PCT_VOTO_BRANCO_NULOBR))

estat_ext <- 
  tabela_1 %>% 
  summarise(media_votos_incext=mean(PCT_VOTO_INCEXT),
            median_votos_incext=median(PCT_VOTO_INCEXT),
            sd_voto_incext=sd(PCT_VOTO_INCEXT),
            media_votos_opext=mean(PCT_VOTO_OPEXT),
            median_votos_opext=median(PCT_VOTO_OPEXT),
            sd_voto_opext=sd(PCT_VOTO_OPEXT),
            media_nullext=mean(PCT_VOTO_BRANCONULOEXT),
            median_nullext=median(PCT_VOTO_BRANCONULOEXT),
            sd_nullext=sd(PCT_VOTO_BRANCONULOEXT))

media_voto_incbr <- estat_br %>%
  pull(media_votos_incbr)

media_voto_opbr <- estat_br %>%
  pull(media_votos_opbr)

media_nullbr <- estat_br %>%
  pull(media_nullbr)

media_voto_incex <- estat_ext %>%
  pull(media_votos_incext)

media_voto_opex <-estat_ext %>%
  pull(media_votos_opext)

media_nullex <- estat_ext %>%
  pull(media_nullext)

median_voto_incbr <- estat_br %>%
  pull(median_votos_incbr)

median_voto_opbr <- estat_br %>%
  pull(median_votos_opbr)

median_nullbr <- estat_br %>%
  pull(median_nullbr)

median_voto_inex <- estat_ext %>%
  pull(median_votos_incext)

median_voto_opex <- estat_ext %>%
  pull(median_votos_opext)

median_nullex <- estat_ext %>%
  pull(median_nullext)

sd_inbr <- estat_br %>%
  pull(sd_voto_incbr)

sd_opbr <- estat_br %>%
  pull(sd_voto_opbr)

sd_nullbr <- estat_br %>%
  pull(sd_nullbr)

sd_inex <- estat_ext %>%
  pull(sd_voto_incext)

sd_opex <- estat_ext %>%
  pull(sd_voto_opext)

sd_nullex <- estat_ext %>%
  pull(sd_nullext)


Tabela_2 <- 
  tibble(Categoria=c("Voto no Incumbente",
                     "Voto na Oposição",
                     "Voto Branco/Nulo"),
         Media_Brasil=c(media_voto_incbr,
                 media_voto_opbr,
                 media_nullbr),
         Media_Exterior=c(media_voto_incex,
                          media_voto_opex,
                          media_nullex),
         Mediana_Brasil=c(median_voto_incbr,
                          median_voto_opbr,
                          median_nullbr),
         Mediana_Exterior=c(median_voto_inex,
                            median_voto_opex,
                            median_nullex),
         SD_BR=c(sd_inbr,
                 sd_opbr,
                 sd_nullbr),
         SD_EXT=c(sd_inex,
                  sd_opex,
                  sd_nullex))

Tabela_2_display <-
  Tabela_2 %>%
  kable(caption = "Estatísticas descritivas",
        col.names = c("Categoria","Média (Brasil) ","Média (Exterior) ",
                      "Mediana (Brasil) ","Mediana (Exterior) ",
                      "Desvio Padrão (Brasil) ","Desvio Padrão (Exterior) "))

tabela_1_display
Tabela_2_display
```


#### Número USP: 10325940

### Resumo 

O objetivo desse trabalho final é utilizar os conteúdos aprendidos durante a disciplina para explorar a relação entre o eleitor brasileiro residir no exterior e o voto na oposição, partindo da ideia de que o voto brasileiro no exterior tende mais à direita do que o voto brasileiro no Brasil. A variável independente (X) é o local de residência do eleitor (Brasil ou exterior) e a variável independente (Y) é a orientação do voto (incumbente ou oposição).

1.    **Introdução** 

Muito se fala, no Brasil, sobre a diferença de votos no âmbito espacial, em especial na diferença de orientação entre as regiões Sul-Sudeste e a região Nordeste. O Nordeste, desde 2006, sendo relacionado ao voto no Partido dos Trabalhadores e a região Sul-Sudeste nas forças anti petistas (PSDB até 2014 e Bolsonaro em 2018). As desigualdades socio-econômicas dentro e entre as regiões do país, assim como as políticas de transferência de renda (tais como o Bolsa Família), são apontadas pela literatura como fatores explicativos por essa diferença (Hunter & Power 2007; Nicolau & Peixoto, 2007;Zucco, 2008;Braga & Zolnerkevic 2020).


Mas o que se tem a dizer sobre o voto no exterior ? Há também uma diferença de padrão de voto entre os brasileiros no exterior e os que residem no país? Na literatura brasileira este aspecto é pouco explorado, embora na academia a discussão sobre o voto imigrante está bem documentada. 

Esse campo de pesquisa tem dois focos principais. Por um lado se tem um foco no impacto que os eleitores imigrantes tem no sistema democrático de seu país natal como também nos processos que levaram à extensão dos direitos políticos para a diaspora (Collyer, 2014; Lafleur, 2017; Rhodes & Harutyunyan, 2010), por outro se tem um foco nas preferências políticas dos cidadãos residentes no exterior e como elas diferem dos eleitores residentes em seu país natal (Fidrmuc & Doyle, 2004; Arkilic, 2021; Rosca,2019; Turcu & Urbatsch, 2020).

Nesse último foco, evidências indicam que o voto imigrante em seu país de origem difere do voto de seus compatriotas, tendendo a votar na oposição (Rosca,2021; Turcu & Urbantsch, 2020), mas, ao mesmo tempo, sendo afetado de alguma forma pelo modelo político-econômico do país para o qual emigram, causando, desta forma, uma diferença interna do voto imigrante. (Fidrmuc & Doyle, 2004; Turcu & Rosca, 2019).

Todo o exposto revela a importância de se estudar o voto imigrante e de como ele se comporta nas eleições de seus países de origem.



2.    **Dados utilizados e procedimentos de tratamento**

Nesse trabalho foram utilizados os dados eleitorais disponíveis no Repositório de Dados do Tribunal Superior Eleitoral (TSE) referentes às eleições presidenciais entre 2002 e 2018, onde estão disponíveis tanto os votos realizados no Brasil (registrados sob todas as UF) como os votos realizados no exterior (registrados sob a sigla ZZ) para ambos os turnos.

O banco foi separado em dois, um para os votos em solo brasileiro e outro para os votos no estrangeiro. Ambos possuem as seguintes informações de interesse: (I) Ano da Eleição, (II) Número do Turno, (III) Sigla da UF (no caso de voto no exterior a mesma é ZZ), (IV) Código do Município, (V) Nome do Municipio, (VI) Número da Zona Eleitoral , (VII) Número Votável, (VIII) Nome do Candidato (IX) quantidade de votos.

No tocante à amostra, tem-se a seleção das eleições de 2002 à 2018 pelo fato de que os bancos correspondentes à essa eleição 


Com a finalidade de operacionalizar os dados (*i.e.*, transformar os conceitos em variáveis), os votos foram divididos em oposição e incumbente, tendo atenção especial às dinâmicas do ano eleitoral. Assim, em 2002 o PT foi contabilizado como oposição e o PSDB como incumbente, enquanto que nos outros anos o PT foi classificado como incumbente. Especial atenção também foi dada no momento de se adotar essa classificação na eleição de 2018, uma vez que o PT não era o incumbente. Optou-se, porém, por classifica-lo como tal, uma vez que havia vencido na eleição anterior, apesar de ter perdido o posto devido ao *impeatchment* dois anos antes.


É importante frisar a diferença no *n* populacional dos dois grupos no momento de realizar a comparação, sendo o número de votantes no Brasil proporcionalmente maior do que o número de votantes do exterior, o que fez com que fosse necessária a utilização de uma padronização dos dados no momento de realizar a análise.


3.  **Modelagem**

No que diz respeito à modelagem dos dados, é necessário se ater aos detalhes das variáveis sendo utilizadas.

Pelo fato de que a variável dependente Y ser uma variável binária ("incumbente" ou "oposição"), *i.e* comporta-se na lógica de "sucesso" ou "fracasso"(ou, melhor, de 0 ou 1), e estamos interessados nas chances disso ocorrer em uma eleição, podemos modelar o problema usando a Distribuição de Bernoulli.

Desta forma, a probabilidade do eleitor brasileiro no exterior em uma eleição votar na oposição é dada por $\phi_i$ e a probabilidade do eleitor brasileiro votar no incumbente é dada por $1 - \phi_i$. Assim, modela-se o problema nos termos da equação abaixo: 

$$f(Y_i = y_i|\phi_i) = \left\{
    \begin{array}{cc}
                \phi_i & \mathrm{se\ } Y_i=1 \\
                1-\phi_i & \mathrm{se\ } Y_i=0 \\
        \end{array} 
    \right.$$

Onde a probabilidade de $Y_i$ (voto brasileiro no exterior) é igual à 1 ("voto na oposição") quando o parâmetro assume o valor de $\phi_i$ e é igual à 0 ("voto no incumbente") quando o parâmetro assume o valor de $1-\phi_i$.


