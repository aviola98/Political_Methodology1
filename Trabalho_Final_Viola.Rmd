---
title: "Trabalho Final"
author: "André Viola"
date: "7/27/2021"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE}
#limpando o documento html final
knitr::opts_chunk$set(echo=FALSE,error=FALSE,warning=FALSE,message=FALSE)
```

```{r}
library(tidyverse)
library(knitr)
library(cowplot)
library(ggpubr)
```

```{r}
#2002
eleicao_2002_exterior <- read_delim("votacao_secao_2002_ZZ.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2002_exterior <-
eleicao_2002_exterior %>%
  filter(NUM_TURNO==2)

eleicao_2002_exterior
eleicao_2002_exterior %>%
  group_by(NUM_VOTAVEL) %>%
  summarise(TOT= sum(QTDE_VOTOS))

20772 + 13742 + 749 + 780 

pct_voto_opo2002ext <-  100*(20772/36043)
pct_voto_inc2002ext <-   100*(13742/36043)
voto_branco2002ext  <-      100*(749/36043)
voto_null2002ext  <-    100*(780/36043)
```

```{r}
#2006
eleicao_2006_exterior <- read_delim("votacao_secao_2006_ZZ.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2006_exterior <-
eleicao_2006_exterior %>%
  filter(NUM_TURNO==2)

eleicao_2006_exterior %>%
  group_by(NUM_VOTAVEL) %>%
  summarise(TOT= sum(QTDE_VOTOS))

17948 + 20912 +985 + 1038 

pct_voto_opo2006ext <-  100*(20912/40883)
pct_voto_inc2006ext <-  100*(17948/40883)
voto_branco2006ext  <-  100*(985/40883)
voto_null2006ext  <-    100*(1038/40883)

```


```{r}
#2010
eleicao_2010_exterior <- read_delim("votacao_secao_2010_ZZ.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2010_exterior <-
eleicao_2010_exterior %>%
  filter(NUM_TURNO==2)

eleicao_2010_exterior %>%
  group_by(NUM_VOTAVEL) %>%
  summarise(TOT= sum(QTDE_VOTOS))

33112 + 47913 + 2313 + 2253

pct_voto_opo2010ext <-  100*(47913/85591)
pct_voto_inc2010ext <-  100*(33112/85591)
voto_branco2010ext  <-  100*(2313/85591)
voto_null2010ext    <-  100*(2253/85591)
```

```{r}
#2014

eleicao_2014_exterior <- read_delim("votacao_secao_2014_BR.txt",
                            delim = ";",
                           locale=locale(encoding="latin1"),
                           col_names=c("DATA_GERACAO","HORA_GERACAO","ANO_ELEICAO","NUM_TURNO","DESCRICAO_ELEICAO","SIGLA_UF","SIGLA_UE","CODIGO_MUNICIPIO","NOME_MUNICIPIO","NUM_ZONA","NUM_SECAO","CODIGO_CARGO","DESCRICAO_CARGO","NUM_VOTAVEL","QTDE_VOTOS"))

eleicao_2014_exterior <-
eleicao_2006_exterior %>%
  filter(NUM_TURNO==2 
         & SIGLA_UF == "ZZ")

eleicao_2014_exterior %>%
  group_by(NUM_VOTAVEL) %>%
  summarise(TOT= sum(QTDE_VOTOS))

17948 + 20912 + 985 + 1038

pct_voto_opo2014ext <-  100*(20912/40883)
pct_voto_inc2014ext <-  100*(17948/40883)
voto_branco2014ext  <-  100*(985/40883)
voto_null2014ext  <-    100*(1038/40883)

 
```

```{r}
#2018

eleicao_2018 <- read_delim("votacao_secao_2018_BR.csv",
                           delim = ";",
                           locale=locale(encoding="latin1"))

eleicao_2018_exterior <-                            
eleicao_2018 %>%
  filter(SG_UF == "ZZ") %>%
  select(-DT_GERACAO,-HH_GERACAO,-CD_TIPO_ELEICAO,-NM_TIPO_ELEICAO,-CD_ELEICAO,-DT_ELEICAO,-TP_ABRANGENCIA,-NM_UE,-NR_SECAO,-CD_CARGO,-SG_UE) %>%
  mutate(PAIS = case_when(NM_MUNICIPIO == "TÓQUIO" ~ "JAPÃO",
                          NM_MUNICIPIO == "OSLO" ~ "NORUEGA",
                          NM_MUNICIPIO == "WASHINGTON" ~ "EUA",
                          NM_MUNICIPIO == "BARCELONA" ~"ESPANHA",
                          NM_MUNICIPIO == "PARIS" ~ "FRANÇA",
                          NM_MUNICIPIO == "GENEBRA" ~"SUIÇA",
                          NM_MUNICIPIO == "VANCOUVER" ~"CANADÁ",
                          NM_MUNICIPIO == "FRANKFURT" ~ "ALEMANHA", NM_MUNICIPIO == "NOVA YORK" ~ "EUA",
                          NM_MUNICIPIO == "BOSTON" ~"EUA",
                          NM_MUNICIPIO == "NAGÓIA" ~ "JAPÃO", 
                          NM_MUNICIPIO == "LONDRES" ~"REINO UNIDO",
                          NM_MUNICIPIO == "CANTÃO" ~"CHINA",
                          NM_MUNICIPIO == "PRAIA"~"CABO VERDE",
                          NM_MUNICIPIO == "MIAMI" ~"EUA",
                          NM_MUNICIPIO == "MONTREAL" ~"CANADÁ",
                          NM_MUNICIPIO == "LISBOA"~"PORTUGAL",
                          NM_MUNICIPIO == "HAMAMATSU"~"JAPÃO",
                          NM_MUNICIPIO == "DUBLIN"~"IRLANDA",
                          NM_MUNICIPIO == "ROMA"~"ITÁLIA",
                          NM_MUNICIPIO == "MUNIQUE"~"ALEMANHA",
                          NM_MUNICIPIO == "MADRI"~"ESPANHA", NM_MUNICIPIO == "HOUSTON"~"EUA",
                          NM_MUNICIPIO == "BRUXELAS"~"BÉLGICA",
                          NM_MUNICIPIO == "MILÃO"~"ITÁLIA",
                          NM_MUNICIPIO == "BUENOS AIRES"~"ARGENTINA",
                          NM_MUNICIPIO == "ATLANTA"~"EUA",
                          NM_MUNICIPIO == "WELLINGTON"~"NOVA ZELÂNDIA",
                          NM_MUNICIPIO == "BERLIM"~"ALEMANHA",
                          NM_MUNICIPIO == "PANAMÁ-PAN"~"PANAMÁ",
                          NM_MUNICIPIO == "TEL AVIV"~"ISRAEL",
                          NM_MUNICIPIO == "ESTOCOLMO"~"SUÉCIA",
                          NM_MUNICIPIO == "FARO"~"PORTUGAL",
                          NM_MUNICIPIO == "ASSUNÇÃO"~"PARAGUAY",
                          NM_MUNICIPIO == "SEUL"~"CORÉIA DO SUL",
                          NM_MUNICIPIO == "PORTO PRÍNCIPE"~"HAITI",
                          NM_MUNICIPIO == "ROTTERDÃ"~"HOLANDA",
                          NM_MUNICIPIO == "CAMBERRA" ~"AUSTRÁLIA",
                          NM_MUNICIPIO == "CHICAGO"~"EUA",
                          NM_MUNICIPIO == "MOSCOU" ~ "RUSSIA",
                          NM_MUNICIPIO == "TORONTO" ~ "CANADÁ",
                          NM_MUNICIPIO == "PEQUIM" ~ "CHINA",
                          NM_MUNICIPIO == "COCHABAMBA"~"BOLÍVIA",
                          NM_MUNICIPIO == "SÃO FRANCISCO" ~"EUA",
                          NM_MUNICIPIO == "SÃO DOMINGOS"~ "REPÚBLICA DOMINICANA",
                          NM_MUNICIPIO == "SYDNEY"~"AUSTRÁLIA",NM_MUNICIPIO == "VARSÓVIA"~"POLONIA",
                          NM_MUNICIPIO == "VIENA"~"AUSTRIA", NM_MUNICIPIO == "SINGAPURA-SING"~"SINGAPURA", 
                          NM_MUNICIPIO == "DÍLI"~ "INDIA",
                          NM_MUNICIPIO == "MONTEVIDÉU"~"URUGUAY",
                          NM_MUNICIPIO == "CARACAS" ~"VENEZUELA",
                          NM_MUNICIPIO == "PEDRO JUAN CABALLERO"~"PARAGUAY",
                          NM_MUNICIPIO == "HARTFORD"~"EUA",
                          NM_MUNICIPIO == "BOGOTÁ"~"COLOMBIA",
                          NM_MUNICIPIO == "QUITO"~"EQUADOR",
                          NM_MUNICIPIO == "CAIENA"~"FRANÇA",
                          NM_MUNICIPIO == "DAR ES SALAAM"~"TANZÂNIA",
                          NM_MUNICIPIO == "LAGOS"~"NIGÉRIA",
                          NM_MUNICIPIO == "PORTO"~"PORTUGAL",
                          NM_MUNICIPIO == "TALIN"~"ESTÔNIA",
                          NM_MUNICIPIO == "BUDAPESTE"~"HUNGRIA",
                          NM_MUNICIPIO == "MAPUTO"~"MOÇAMBIQUE",
                          NM_MUNICIPIO == "PRETÓRIA"~"AFRICA DO SUL",
                          NM_MUNICIPIO == "MANILA"~"FILIPINAS",
                          NM_MUNICIPIO == "TEGUCIGALPA"~"HONDURAS",
                          NM_MUNICIPIO == "BUCARESTE"~"ROMÊNIA",
                          NM_MUNICIPIO == "LIMA"~"PERU",
                          NM_MUNICIPIO == "LOS ANGELES"~"EUA",
                          NM_MUNICIPIO == "NAIRÓBI"~"QUENIA",
                          NM_MUNICIPIO == "SALTO DEL GUAIRÁ"~"PARAGUAY",
                          NM_MUNICIPIO == "TAIPÉ"~"TAIWAN",
                          NM_MUNICIPIO == "CIUDAD DEL ESTE"~"PARAGUAY",
                          NM_MUNICIPIO == "STA C LA SIERRA-BOLI"~"BOLÍVIA",
                          NM_MUNICIPIO == "XANGAI"~"CHINA",
                          NM_MUNICIPIO == "SÃO JOSÉ"~"EUA",
                          NM_MUNICIPIO == "CHUY"~"URUGUAY",
                          NM_MUNICIPIO == "BRATISLAVA"~"ESLOVÁQUIA",
                          NM_MUNICIPIO == "OTTAWA"~"CANADÁ",
                          NM_MUNICIPIO =="BEIRUTE"~"LIBANO",
                          NM_MUNICIPIO == "JACARTA"~"INDONÉSIA",
                          NM_MUNICIPIO == "MÉXICO-MEXI"~"MÉXICO",
                          NM_MUNICIPIO == "TEERÃ"~"IRÃ",
                          NM_MUNICIPIO =="MASCATE"~"OMÃ",
                          NM_MUNICIPIO == "HONG KONG-HONG"~"HONG KONG",
                          NM_MUNICIPIO == "COPENHAGUE-DINA"~"DINAMARCA",
                          NM_MUNICIPIO == "ABU DHABI"~"EAU",
                          NM_MUNICIPIO == "PARAMARIBO"~"SURINAME",
                          NM_MUNICIPIO == "NOVA DELHI"~"INDIA",
                          NM_MUNICIPIO == "KUAITE" ~"KUAITE",
                          NM_MUNICIPIO == "MENDOZA"~"ARGENTINA",
                          NM_MUNICIPIO == "KIEV" ~ "UCRÂNIA",
                          NM_MUNICIPIO == "ATENAS" ~ "GRÉCIA",
                          NM_MUNICIPIO == "RIADE"~"ARÁBIA SAUDITA",
                          NM_MUNICIPIO == "DOHA" ~"QATAR",
                          NM_MUNICIPIO == "CIUDAD GUYANA"~"VENEZUELA",
                          NM_MUNICIPIO == "ZAGREB"~"CROÁCIA",
                          NM_MUNICIPIO == "CONCEPCIÓN"~"CHILE",
                          NM_MUNICIPIO == "AMÃ"~"JORDÂNIA",
                          NM_MUNICIPIO == "LUANDA"~"ANGOLA",
                          NM_MUNICIPIO == "BISSAU"~"GUINÉ BISSAU",
                          NM_MUNICIPIO == "RABAT"~"MARROCOS",
                          NM_MUNICIPIO == "ZURIQUE"~"SUIÇA",
                          NM_MUNICIPIO == "WINDHOEK"~"NAMÍBIA",
                        NM_MUNICIPIO == "RAMALLAH-PALE"~"PALESTINA", NM_MUNICIPIO == "TUNIS"~"TUNISIA", NM_MUNICIPIO == "CIUDAD GUAYANA"~"VENEZUELA", NM_MUNICIPIO == "GUATEMALA"~"GUATEMALA", NM_MUNICIPIO == "BELGRADO"~"SÉRVIA", NM_MUNICIPIO == "ARTIGAS"~"URUGUAY",
                        NM_MUNICIPIO == "LA PAZ"~"BOLÍVIA",
                        NM_MUNICIPIO == "SANTIAGO" ~"CHILE",
                        NM_MUNICIPIO == "ABIDJÃ"~"COSTA DO MARFIM", NM_MUNICIPIO == "ACCRA-GANA"~"GANA",
                        NM_MUNICIPIO == "ANCARA"~"TURQUIA", NM_MUNICIPIO == "BANGKOK"~"TAILANDIA", NM_MUNICIPIO == "CAIRO"~"EGITO",
                      NM_MUNICIPIO == "CIDADE DO CABO"~"AFRICA DO SUL",
                      NM_MUNICIPIO == "CÓRDOBA"~"ARGENTINA",
                      NM_MUNICIPIO == "DACAR"~"SENEGAL",
                      NM_MUNICIPIO == "ENCARNACIÓN"~"PARAGUAY",
                      NM_MUNICIPIO == "GEORGETOWN"~"GUIANA",
                      NM_MUNICIPIO == "HANÓI"~"VIETNÃ",
                      NM_MUNICIPIO == "HAVANA"~"CUBA",
                      NM_MUNICIPIO == "HELSINQUE"~"FINLÂNDIA",
                      NM_MUNICIPIO == "ISTAMBUL"~"TURQUIA",
                      NM_MUNICIPIO == "KATMANDU"~"NEPAL",
                      NM_MUNICIPIO == "KINGSTON-JAMAICA"~"JAMAICA",
                      NM_MUNICIPIO == "KINSHASA"~"REP.DEM. DO CONGO",
                      NM_MUNICIPIO == "KUALA LUMPUR"~"MALÁSIA",
                      NM_MUNICIPIO == "LIUBLIANA"~"ESLOVÊNIA",
                      NM_MUNICIPIO == "LUSACA"~"ZÂMBIA",
                      NM_MUNICIPIO == "MANÁGUA"~"NICARÁGUA",
                      NM_MUNICIPIO == "NASSAU"~"BAHAMAS",
                      NM_MUNICIPIO == "NICOSIA"~"CIPRE",
                      NM_MUNICIPIO == "PORT OF SPAIN"~"TRINIDAD E TOBAGO",
                      NM_MUNICIPIO == "PRAGA"~"REPÚBLICA TCHECA",
                      NM_MUNICIPIO == "RIO BRANCO"~"URUGUAY",
                      NM_MUNICIPIO == "SÃO SALVADOR"~"EL SALVADOR"
                        
                        
                       ))

eleicao_2018_exterior <-
eleicao_2018_exterior %>%
  mutate(REGIAO=case_when(PAIS %in% c("JAPÃO",
                          "CHINA",
                          "ARÁBIA SAUDITA",
                          "EAU",
                          "FILIPINAS",
                          "HONG KONG",
                          "INDONÉSIA",
                          "IRÃ",
                          "CORÉIA DO SUL",
                          "ISRAEL",
                          "JORDÂNIA",
                          "KUAITE",
                          "LIBANO",
                          "MALÁSIA",
                          "INDIA",
                          "QATAR",
                          "SINGAPURA",
                          "TAILANDIA",
                          "TAIWAN",
                          "TURQUIA",
                          "NEPAL",
                          "OMÃ",
                          "VIETNÃ",
                          "PALESTINA") ~ "ÁSIA",
                          PAIS %in% c("AFRICA DO SUL",
                          "ANGOLA",
                          "CABO VERDE",
                          "COSTA DO MARFIM",
                          "EGITO",
                          "GANA",
                          "ZÂMBIA",
                          "GUINÉ BISSAU",
                          "MARROCOS",
                          "MOÇAMBIQUE",
                          "NAMÍBIA",
                          "TANZÂNIA",
                          "NIGÉRIA",
                          "QUENIA",
                          "SENEGAL",
                          "TUNISIA",
                          "REP.DEM. DO CONGO")~"ÁFRICA",
                          PAIS %in% c("ALEMANHA",
                          "AUSTRIA",
                          "BÉLGICA",
                          "CIPRE",
                          "CROÁCIA",
                         "DINAMARCA",
                        "ESLOVÁQUIA",
                        "ESLOVÊNIA",
                        "ESPANHA",
                        "ESTÔNIA",
                       "FINLÂNDIA",
                       "FRANÇA",
                       "GRÉCIA",
                       "HOLANDA",
                       "HUNGRIA",
                       "IRLANDA",
                       "ITÁLIA",
                      "NORUEGA",
                      "POLONIA",
                      "PORTUGAL",
                      "REINO UNIDO",
                      "REPÚBLICA TCHECA",
                     "ROMÊNIA",
                     "RUSSIA",
                     "SÉRVIA",
                     "SUÉCIA",
                     "SUIÇA",
                     "UCRÂNIA")~"EUROPA",
                     PAIS %in% c("AUSTRÁLIA",
                     "NOVA ZELÂNDIA") ~ "OCEANIA",
                     PAIS %in% c("PARAGUAY",
                                 "EUA",
                                 "GUIANA",
                                 "BOLÍVIA",
                                 "TRINIDAD E TOBAGO",
                                 "VENEZUELA",
                                 "EL SALVADOR",
                                 "SURINAME",
                                 "GUATEMALA",
                                 "JAMAICA",
                                 "REPÚBLICA DOMINICANA",
                                 "URUGUAY",
                                 "HONDURAS",
                                 "BAHAMAS",
                                 "PERU",
                                 "HAITI",
                                 "COSTA RICA",
                                 "MÉXICO",
                                 "CANADÁ",
                                 "ARGENTINA",
                                 "CHILE",
                                 "PANAMÁ",
                                 "EQUADOR",
                                 "NICARÁGUA",
                                 "COLOMBIA",
                                 "CUBA")~"AMÉRICA"))


eleicao_2018_BR <- eleicao_2018 %>%
  filter(SG_UF != "ZZ") %>%
  select(-DT_GERACAO,-HH_GERACAO,-CD_TIPO_ELEICAO,-NM_TIPO_ELEICAO,-CD_ELEICAO,-DT_ELEICAO,-TP_ABRANGENCIA,-NM_UE,-NR_SECAO,-CD_CARGO,-SG_UE)


```

```{r}
#construindo tablela
voto_haddad_exterior <- 
eleicao_2018_exterior %>%
  filter(NR_TURNO == 2) %>%
  group_by(NM_VOTAVEL) %>%
  summarise(TOT = sum(QT_VOTOS)) %>%
  filter(NM_VOTAVEL=="FERNANDO HADDAD") %>%
  pull(TOT)

voto_bozo_exterior <- 
eleicao_2018_exterior %>%
  filter(NR_TURNO == 2) %>%
  group_by(NM_VOTAVEL) %>%
  summarise(TOT = sum(QT_VOTOS)) %>%
  filter(NM_VOTAVEL=="JAIR MESSIAS BOLSONARO") %>%
  pull(TOT)

voto_haddad_brasil <-
  eleicao_2018_BR %>%
  filter(NR_TURNO == 2) %>%
  group_by(NM_VOTAVEL) %>%
  summarise(TOT = sum(QT_VOTOS)) %>%
  filter(NM_VOTAVEL=="FERNANDO HADDAD") %>%
  pull(TOT)

voto_bozo_brasil <-
  eleicao_2018_BR %>%
  filter(NR_TURNO == 2) %>%
  group_by(NM_VOTAVEL) %>%
  summarise(TOT = sum(QT_VOTOS)) %>%
  filter(NM_VOTAVEL=="JAIR MESSIAS BOLSONARO") %>%
  pull(TOT)


#INCLUIR VOTO BRANCO E NULO JUNTO





tot_votos <- 47040906+57797847
tot_votos_ext <-53730+131671
tot_votos_br <- 46987176+57666176

Pct_votos_bozo_ext <- 100*(voto_bozo_exterior/tot_votos_ext)
Pct_votos_haddad_ext <- 100*(voto_haddad_exterior/tot_votos_ext)
Pct_votos_bozo_br <- 100*(voto_bozo_brasil/tot_votos_br)
Pct_votos_haddad_br <- 100*(voto_haddad_brasil/tot_votos_br)

tabela_votos <- tibble(Nome_Candidato=c("FERNANDO HADDAD","JAIR MESSIAS BOLSONARO"),
                       Voto_Exterior = c(voto_haddad_exterior,voto_bozo_exterior),
                       Voto_Brasil = c(voto_haddad_brasil,voto_bozo_brasil),
                       Total = c(voto_haddad_brasil+voto_haddad_exterior,
                                 voto_bozo_brasil+voto_bozo_exterior)) %>%
  kable(caption = "Tabela de votos no Exterior e no Brasil",
        col.names = c("Nome Candidato","Voto no Exterior","Voto no Brasil","Total")) 



tabela_votos_pct <- tibble(Nome_Candidato=c("FERNANDO HADDAD","JAIR MESSIAS BOLSONARO"),
                       Voto_Exterior = c(voto_haddad_exterior,voto_bozo_exterior),
                       Voto_Brasil = c(voto_haddad_brasil,voto_bozo_brasil),
                       Pct_voto_br=c(Pct_votos_haddad_br,Pct_votos_bozo_br),
                       Pct_voto_ext=c(Pct_votos_haddad_ext,Pct_votos_bozo_ext),
                       Total = c(voto_haddad_brasil+voto_haddad_exterior,
                                 voto_bozo_brasil+voto_bozo_exterior))
```

#### Número USP: 10325940

### Resumo 

O objetivo desse trabalho final é utilizar os conteúdos aprendidos durante a disciplina para testar se há diferença entre a orientação ideológica dos votos brasileiros no exterior e os votos brasileiros no Brasil nas eleições para presidente no ano de 2018, partindo da ideia de que o voto brasileiro no exterior tende mais à direita do que o voto brasileiro no Brasil. A variável independente (X) é o local de residência do eleitor (Brasil ou exterior) e a variável independente (Y) é a orientação política do voto (direita ou esquerda).

1.    **Introdução** 

Muito se fala, no Brasil, sobre a diferença de votos no âmbito espacial, em especial na diferença de orientação entre as regiões Sul-Sudeste e a região Nordeste. O Nordeste, desde 2006, sendo relacionado ao voto no Partido dos Trabalhadores e a região Sul-Sudeste nas forças anti petistas (PSDB até 2014 e Bolsonaro em 2018). As razões para essa divisão está bem documentada na literatura (Hunter & Power 2007; Nicolau & Peixoto, 2007;Zucco, 2008;Braga & Zolnerkevic 2020), sendo que de acordo com a a mesma, o Nordeste, por ser a região mais pobre se beneficiou mais dos programas de transferência de renda dos governos petistas criando um vínculo de gratidão, enquanto que, por outro lado, os escandalos de corrupção como o "Mensalão" minaram a confiança no partido por parte das pessoas com maiores condições de vida, que se concentram no eixo Sul-Sudeste.  



Mas o que se tem a dizer sobre o voto no exterior ? Há também uma diferença de padrão de voto entre os brasileiros no exterior e os que residem no país? Na literatura brasileira este aspecto é pouco explorado, embora na academia a discussão sobre o voto imigrante está bem documentada. 

Esse campo de pesquisa tem dois focos principais. Por um lado se tem um foco no impacto que os eleitores imigrantes tem no sistema democrático de seu país natal como também nos processos que levaram à extensão dos direitos políticos para a diaspora (Collyer, 2014; Lafleur, 2017; Rhodes & Harutyunyan, 2010), por outro se tem um foco nas preferências políticas dos cidadãos residentes no exterior e como elas diferem dos eleitores residentes em seu país natal (Fidrmuc & Doyle, 2004; Arkilic, 2021; Rosca,2019; Turcu & Urbatsch, 2020).

Nesse último foco, evidências indicam que o voto imigrante em seu país de origem difere do voto de seus compatriotas, tendendo mais à direita(Rosca,2021; Turcu & Urbantsch, 2020), mas, ao mesmo tempo, sendo afetado de alguma forma pelo modelo político-econômico do país para o qual emigram, causando, desta forma, uma diferença interna do voto imigrante. (Fidrmuc & Doyle, 2004; Turcu & Rosca, 2019).




2.    **Dados utilizados e procedimentos de tratamento**

Nesse trabalho foram utilizados os dados eleitorais disponíveis no Repositório de Dados do Tribunal Superior Eleitoral (TSE) referentes à eleição presidencial de 2018, onde estão disponíveis tanto os votos realizados no Brasil (registrados sob todas as UF) como os votos realizados no exterior (registrados sob a sigla ZZ) para ambos os turnos.

O banco foi separado em dois, um para os votos em solo brasileiro e outro para os votos no estrangeiro. Ambos possuem as seguintes informações de interesse: (I) Ano da Eleição, (II) Número do Turno, (III) Sigla da UF (no caso de voto no exterior a mesma é ZZ), (IV) Código do Município, (V) Nome do Municipio, (VI) Número da Zona Eleitoral , (VII) Número Votável, (VIII) Nome do Candidato (IX) quantidade de votos.

Em seguida foi também realizada uma tabela onde se compara a quantidade de voto que cada candidato recebeu no Brasil e no Exterior. 


```{r}

tabela_votos_pct_kb <-
tabela_votos_pct %>%
  select(Nome_Candidato,Pct_voto_br,Pct_voto_ext,Total) %>%
  kable(caption = "Tabela 1. Porcentagens de voto no Brasil e Exterior por Cadidato (Contada tendo como base o total de cada lugar)",
        col.names = c("Nome Candidato","% votos no Brasil","% votos no exterior","Total de Votos"))

tabela_votos_pct_kb
```









É importante frisar a diferença no *n* populacional dos dois grupos no momento de realizar a comparação, sendo o número de votantes no Brasil proporcionalmente maior do que o número de votantes do exterior, o que fez com que fosse necessária a utilização de uma padronização dos dados no momento de realizar a análise.



```{r}
#verificando o total de votos no segundo turno exterior
tabela_votos_pct <-
tabela_votos_pct %>%
  mutate(Nome_Candidato=case_when(Nome_Candidato=="FERNANDO HADDAD"~"HADDAD",
                                  Nome_Candidato=="JAIR MESSIAS BOLSONARO"~"BOLSONARO"))
#eleicao_2018_exterior %>%
#  filter(NR_TURNO == 2) %>%
 # group_by(NM_VOTAVEL) %>%
#  summarise(TOT = sum(QT_VOTOS))

grafico_voto_exterior2018 <-
tabela_votos_pct %>%
  group_by(Nome_Candidato) %>%
  ggplot()+
  geom_col(aes(x=Nome_Candidato,
               y=Pct_voto_ext,
               fill=Nome_Candidato),
           color="black",
           alpha=0.5) +
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro no exterior (2018)")+
  xlab("Candidato")+
  ylab("Votos") +
  theme(legend.position="none")
```

```{r}
#eleicao_2018_BR %>%
 # filter(NR_TURNO == 2) %>%
  #group_by(NM_VOTAVEL) %>%
  #summarise(TOT = sum(QT_VOTOS))

grafico_voto_brasil2018 <-
tabela_votos_pct %>%
  group_by(Nome_Candidato) %>%
  ggplot()+
  geom_col(aes(x=Nome_Candidato,
               y=Pct_voto_br,
               fill=Nome_Candidato),
           color="black",
           binwidth = 2,
           alpha=0.5) +
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro no Brasil (2018)")+
  xlab("Candidato")+
  ylab("Votos") +
  theme(legend.position="none") 
```

```{r}
library(cowplot)
plot_grid(grafico_voto_brasil2018,grafico_voto_exterior2018, ncol=2)
```

```{r}
#média de votos na direita e na esquerda




```










```{r}
#dividing the vote by country of origin

#goal(identify wheter there are differences in voting behaviour dependending on the host country)

eleicao_2018_pct_por_reg_pais <-
eleicao_2018_exterior %>%
  filter(NR_TURNO==2) %>%
  group_by(REGIAO,PAIS, NM_VOTAVEL) %>%
  summarise(TOT_VOTOS_CAND=sum(QT_VOTOS)) %>%
  mutate(TOT_VOTOS=sum(TOT_VOTOS_CAND)) %>%
  mutate(PCT_VOTOS=100*(TOT_VOTOS_CAND/TOT_VOTOS)) %>%
  mutate(NM_VOTAVEL=case_when(NM_VOTAVEL=="FERNANDO HADDAD"~"HADDAD",
                              NM_VOTAVEL=="JAIR MESSIAS BOLSONARO"~"BOLSONARO"))
  

#graph eu 
voto_br_europa2018 <-
eleicao_2018_pct_por_reg_pais %>%
  filter(NM_VOTAVEL %in% c("HADDAD","BOLSONARO"),
         REGIAO == "EUROPA") %>%
  group_by(NM_VOTAVEL) %>%
  ggplot() +
   geom_col(aes(x=PAIS,
               y=PCT_VOTOS,
               fill=NM_VOTAVEL),
           color="black",
           binwidth = 2,
           alpha=0.5

        ) +
    coord_flip()+
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro-Europa")+
  ylab("Votos") +
    theme(legend.position="none") 



#graph asia 
voto_br_asia2018 <- 
  eleicao_2018_pct_por_reg_pais %>%
  filter(NM_VOTAVEL %in% c("HADDAD","BOLSONARO"),
         REGIAO == "ÁSIA") %>%
  group_by(NM_VOTAVEL) %>%
  ggplot() +
   geom_col(aes(x=PAIS,
               y=PCT_VOTOS,
               fill=NM_VOTAVEL),
           color="black",
           binwidth = 2,
           alpha=0.5

         ) +
    coord_flip()+
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro-Ásia")+
  ylab("Votos") +
   theme(legend.position="none") 



#graph america
voto_br_america2018 <-
  eleicao_2018_pct_por_reg_pais %>%
  filter(NM_VOTAVEL %in% c("HADDAD","BOLSONARO"),
         REGIAO == "AMÉRICA") %>%
  group_by(NM_VOTAVEL) %>%
  ggplot() +
   geom_col(aes(x=PAIS,
               y=PCT_VOTOS,
               fill=NM_VOTAVEL),
           color="black",
           binwidth = 2,
           alpha=0.5

           ) +
    coord_flip()+
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro-América")+
  ylab("Votos") +
   theme(legend.position="none") 



#graph africa
voto_br_africa2018 <-
  eleicao_2018_pct_por_reg_pais %>%
  filter(NM_VOTAVEL %in% c("HADDAD","BOLSONARO"),
         REGIAO == "ÁFRICA") %>%
  group_by(NM_VOTAVEL) %>%
  ggplot() +
   geom_col(aes(x=PAIS,
               y=PCT_VOTOS,
               fill=NM_VOTAVEL),
           color="black",
           binwidth = 2,
           alpha=0.5
            ) +
    coord_flip()+
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro-África")+
  ylab("Votos") +
   theme(legend.position="none") 



#graph oceania
voto_br_oceania2018 <-
  eleicao_2018_pct_por_reg_pais %>%
  filter(NM_VOTAVEL %in% c("HADDAD","BOLSONARO"),
         REGIAO == "OCEANIA") %>%
  group_by(NM_VOTAVEL) %>%
  ggplot() +
   geom_col(aes(x=PAIS,
               y=PCT_VOTOS,
               fill=NM_VOTAVEL),
           color="black",
           binwidth = 2,
           alpha=0.5
           ) +
    coord_flip()+
  scale_fill_manual(values = c("HADDAD"="Red","BOLSONARO"="Blue")) +
  ggtitle("Voto brasileiro-Oceania")+
  ylab("Votos") +
    theme(legend.position="none") 



ggarrange(voto_br_africa2018,voto_br_america2018 + remove("x.text"),
          ncol = 2)

ggarrange(voto_br_asia2018,voto_br_europa2018,
            ncol = 2)

voto_br_oceania2018
```








